<%- include('./includes/head.ejs') %>
<body>

    <%- include('./includes/navigation.ejs') %>
<!-- main content -->
    <!-- [ Main Content ] start -->
    <div class="pcoded-main-container">
        <div class="pcoded-wrapper">
            <div class="pcoded-content">
                <div class="pcoded-inner-content">
                    <!-- [ breadcrumb ] start -->
                    <div class="page-header">
                        <div class="page-block">
                            <div class="row align-items-center">
                                <div class="col-md-12">
                                    <div class="page-header-title">
                                        <h5 class="m-b-10">Monthly Balance</h5>
                                    </div>
                                    <ul class="breadcrumb">
                                        <li class="breadcrumb-item"><a href="/dashboard"><i class="feather icon-home"></i></a></li>
                                        <li class="breadcrumb-item"><a href="#">Monthly Balance</a></li>
                                    </ul>
                                </div>
                            </div>
                        </div>
                    </div>
                    <!-- [ breadcrumb ] end -->
                    <div class="h-main-body">
                        <div class="page-wrapper">
                            <!-- [ Main Content ] start -->
                            <div class="row">
                                <div class="month-chart">
                                  <div class="month-chart-bar">
                                    <p class="month-chart-title">Monthly Balance</p>
                                    <div id="barchart"></div>
                                  </div>                                  
                                  <div class="month-chart-pie">
                                    <p class="month-chart-title">Expense</p>
                                    <div id="radialchart"></div>
                                  </div>
                                </div>
                                </div>
                            </div>
                            <!-- [ Main Content ] end -->
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <!-- [ Main Content ] end -->
<!-- end of main -->
    <%- include('./includes/script.ejs') %>
    <!---------- Apexcharts ------->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/apexcharts/3.35.3/apexcharts.min.js"></script>

    <script>
      var option1 = {
          series: [{
          name: 'Income',
          data: [`<%= income[0]%>`, `<%= income[1]%>`, `<%= income[2]%>`, `<%= income[3]%>`, `<%= income[4]%>`, `<%= income[5]%>`, `<%= income[6]%>`, `<%= income[7]%>`, `<%= income[8]%>`, `<%= income[9]%>`, `<%= income[10]%>`, `<%= income[11]%>`]
        }, {
          name: 'Expense',
          data: [`<%= expense[0]%>`, `<%= expense[1]%>`, `<%= expense[2]%>`, `<%= expense[3]%>`, `<%= expense[4]%>`, `<%= expense[5]%>`, `<%= expense[6]%>`, `<%= expense[7]%>`, `<%= expense[8]%>`, `<%= expense[9]%>`, `<%= expense[10]%>`, `<%= expense[11]%>`]
        }],
          chart: {
          type: 'bar',
          height: 350
        },
        plotOptions: {
          bar: {
            horizontal: false,
            columnWidth: '55%',
            endingShape: 'rounded'
          },
        },
        dataLabels: {
          enabled: false
        },
        stroke: {
          show: true,
          width: 2,
          colors: ['transparent']
        },
        xaxis: {
          categories: ['Jan','Feb', 'Mar', 'Apr', 'May', 'Jun', 'Jul', 'Aug', 'Sep', 'Oct','Nov','Dec'],
        },
        yaxis: {
          title: {
            text: 'VND'
          }
        },
        fill: {
          opacity: 1
        },
        tooltip: {
          y: {
            formatter: function (val) {
              return  val + " VND"
            }
          }
        }
        };

        var chart = new ApexCharts(document.querySelector("#barchart"), option1);
        chart.render();
    </script>

    <script>
        var option2 = {
          series: [ 0, 0, 0, 0, 11000000, 0, 0, 420000, `<%= category[8]%>`],
          labels: ['Auto', 'Charity', 'Childcare', 'Education', 'Necessities', 'Entertainment', 'Health', 'Utilities', 'Others'],
          chart: {
          width: 400,
          type: 'donut',
        },
        plotOptions: {
          pie: {
            startAngle: -90,
            endAngle: 270
          }
        },
        dataLabels: {
          enabled: false
        },
        fill: {
          type: 'gradient',
        },
        legend: {
          formatter: function(val, opts) {
            return val + " - " + opts.w.globals.series[opts.seriesIndex]
          }
        },
        
        responsive: [{
          breakpoint: 480,
          options: {
            chart: {
              width: 200
            },
            legend: {
              position: 'bottom'
            }
          }
        }]
        };

        var chart = new ApexCharts(document.querySelector("#piechart"), option2);
        chart.render();
    </script>

    <script>
      var option3 = {
        series: [ 0, 0, 0, 0, 11000000, 0, 0, 420000, `<%= category[8]%>`],
        chart: {
        width: 380,
        type: 'pie',
      },
      labels: ['Auto', 'Charity', 'Childcare', 'Education', 'Necessities', 'Entertainment', 'Health', 'Utilities', 'Others'],
      responsive: [{
        breakpoint: 480,
        options: {
          chart: {
            width: 200
          },
          legend: {
            position: 'bottom'
          }
        }
      }]
      };

      var chart = new ApexCharts(document.querySelector("#simplechart"), option3);
      chart.render();
    </script>
    <script>
      var option4 = {
        series: [ `<%= (Math.round(category[0]/category[9]*100 * 100) / 100).toFixed(2) %>`, `<%=(Math.round(category[1]/category[9]*100 * 100) / 100).toFixed(2) %>`, `<%= (Math.round(category[2]/category[9]*100 * 100) / 100).toFixed(2) %>`, `<%= (Math.round(category[3]/category[9]*100 * 100) / 100).toFixed(2)%>`, `<%=(Math.round(category[4]/category[9]*100 * 100) / 100).toFixed(2) %>`, `<%= (Math.round(category[5]/category[9]*100 * 100) / 100).toFixed(2)%>`, `<%= (Math.round(category[6]/category[9]*100 * 100) / 100).toFixed(2)%>`, `<%=  (Math.round(category[7]/category[9]*100 * 100) / 100).toFixed(2) %>`, `<%=  (Math.round(category[8]/category[9]*100 * 100) / 100).toFixed(2) %>`],
        chart: {
        height: 350,
        type: 'radialBar',
      },
      plotOptions: {
        radialBar: {
          dataLabels: {
            name: {
              fontSize: '22px',
            },
            value: {
              fontSize: '16px',
            },
            total: {
              show: true,
              label: 'Total',
              formatter: function (w) {
                // By default this function returns the average of all series. The below is just an example to show the use of custom formatter function
                return `<%= category[9] %> `
              }
            }
          }
        }
      },
      labels: ['Auto', 'Charity', 'Childcare', 'Education', 'Necessities', 'Entertainment', 'Health', 'Utilities', 'Others'],
      };

      var chart = new ApexCharts(document.querySelector("#radialchart"), option4);
      chart.render();
    </script>
</body>
</html>